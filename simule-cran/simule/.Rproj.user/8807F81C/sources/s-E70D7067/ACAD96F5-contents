plotbrain.simule <-function(simuleresult, type = "task", neighbouroption = "task",
                            subID = NULL, index = NULL, layout = NULL, color = "black", label = NULL){
  subID = unique(subID)
  index = unique(index)
  .env = "environment: namespace:simule"
  gadj = returngraph.simule(
    simuleresult,
    type = type,
    neighbouroption = neighbouroption,
    subID = subID,
    index = index
  )
  title = .maketitle(
    type = type,
    subID = subID,
    index = index,
    graphlabel = graphlabel,
    neighbouroption = neighbouroption
  )

  palette(categorical_pal(length(simuleresult$Graphs) + 1))
  rgl.open()
  par3d(windowRect = c(100,100,1000,1000))

  misc3d::contour3d(neurobase::readnii(system.file("MNI152_T1_1mm_brain.nii.gz", package = "brainR"),reorient = FALSE),
                    level = 3000,
                    alpha = 0.5, draw = TRUE,add=FALSE,rescale = FALSE)

  igraph::rglplot(
    gadj,
    layout = layout,
    vertex.label.font = 2,
    vertex.shape = "circle",
    vertex.label.color = "black",
    vertex.color = color,
    vertex.label = label,
    edge.width= 100,
    vertex.label.cex = .7,
    vertex.size = 300,
    vertex.frame.color = "white",
    add = TRUE,
    draw = TRUE,
    rescale = FALSE
  )

  bgplot3d({
    plot.new()
    title(main = title, line = 3)
    legend(
      "topright" ,
      legend = c(paste("task", c(
        1:length(simuleresult$Graphs)
      ), "specific"), "share"),
      col = categorical_pal(length(simuleresult$Graphs) + 1),
      pch = 16,cex=1, inset=c(0.02)
    )
  })



}
